<!doctype html>
<html>
<head>
    <title>Chapter 5 - Vectors</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel='stylesheet' href="../prism.css">
    <link rel='stylesheet' href="../style.css">
</head>
<body class="line-numbers">
    <article>
        <h1>Chapter 5 - Vectors</h1>
        <p>
            In game development, many physical and graphical objects require us to manipulate objects which
            have either a position or a direction in the game world. These objects are often best described
            by using a mathematical object called a vector.
        </p>
        <p>
            A vector is a mathematical (or geometric) object that has a magnitude and direction. There are many
            ways to represent a vector, but the most common one is the Cartesian vector. In 2D, this vector has two
            components, <span class="copyable-formula">x</span><math><mi>x</mi></math> and <span class="copyable-formula">y</span>
            <math><mi>y</mi></math>, and these components represent how far along is a vector displaced in the
            <span class="copyable-formula">x</span><math><mi>x</mi></math> and <span class="copyable-formula">y</span>
            <math><mi>y</mi></math> directions. If you recall in the previous chapters, we used this system to place
            the rectangle in the scene but also to move it around.
        </p>
        <figure>
            <img src="vector.svg" class="half-width" />
            <figcaption class="image-caption">A representation of three vectors and their components. The first number
                in each vector is the <span class="copyable-formula">x</span><math><mi>x</mi></math> coordinate, the
                second is the <span class="copyable-formula">y</span><math><mi>y</mi></math> coordinate. Note that in
                computer graphics the <span class="copyable-formula">y</span><math><mi>y</mi></math> coordinate points downward.
            </figcaption>
        </figure>
        <p>
            Vectors have many useful properties that make them essential in game programming. Vectors can be added,
            and this is done by adding the respective components of each vector. For example, the sum of the vectors
            <span class="copyable-formula">(2, 3)</span><math>
                <mfenced>
                    <mrow>
                        <mn>2</mn>
                        <mo>,</mo>
                        <mn>3</mn>
                    </mrow>
                </mfenced>
            </math> and <span class="copyable-formula">(2, -1)</span><math>
                <mfenced>
                    <mrow>
                        <mn>2</mn>
                        <mo>,</mo>
                        <mn>-1</mn>
                    </mrow>
                </mfenced>
            </math> is <span class="copyable-formula">(2 + 2, 3 + (-1))</span><math>
                <mfenced>
                    <mrow>
                        <mn>2</mn>
                        <mo>+</mo>
                        <mn>2</mn>
                        <mo>,</mo>
                        <mn>3</mn>
                        <mo>+</mo>
                        <mfenced><mn>-1</mn></mfenced>
                    </mrow>
                </mfenced>
            </math> or <span class="copyable-formula">(4, 2)</span><math>
                <mfenced>
                    <mrow>
                        <mn>4</mn>
                        <mo>,</mo>
                        <mn>2</mn>
                    </mrow>
                </mfenced>
            </math>. Graphically, this is represented by the second vector pointing
            away from the tip of the first vector.
        </p>
        <figure>
            <img src="vectorsum.svg" class="half-width" />
            <figcaption class="image-caption">The sum of two vectors. The resulting vector's
                <span class="copyable-formula">x</span><math><mi>x</mi></math> component is the sum of the
                <span class="copyable-formula">x</span><math><mi>x</mi></math> components of the initial
                vectors, similarly the <span class="copyable-formula">y</span><math><mi>y</mi></math>
                component is the sum of the <span class="copyable-formula">y</span><math><mi>y</mi></math>
                components of the initial vectors.
            </figcaption>
        </figure>
        <p>
            Similarly, vectors can be subtracted. When subtracting two vectors, the result is equal to the first
            vector's components minus the second vector's components. For example, when we subtract the vector
            <span class="copyable-formula">(1, 3)</span><math>
                <mfenced>
                    <mrow>
                        <mn>1</mn>
                        <mo>,</mo>
                        <mn>3</mn>
                    </mrow>
                </mfenced>
            </math> from the vector <span class="copyable-formula">(4, 5)</span><math>
                <mfenced>
                    <mrow>
                        <mn>4</mn>
                        <mo>,</mo>
                        <mn>5</mn>
                    </mrow>
                </mfenced>
            </math>, the result is <span class="copyable-formula">(4 - 1, 5 - 3)</span><math>
                <mfenced>
                    <mrow>
                        <mn>4</mn>
                        <mo>-</mo>
                        <mn>1</mn>
                        <mo>,</mo>
                        <mn>5</mn>
                        <mo>-</mo>
                        <mn>3</mn>
                    </mrow>
                </mfenced>
            </math> or <span class="copyable-formula">(3, 2)</span><math>
                <mfenced>
                    <mrow>
                        <mn>3</mn>
                        <mo>,</mo>
                        <mn>2</mn>
                    </mrow>
                </mfenced>
            </math>.
        </p>
        <p>
            Vectors can also be scaled, which means we can multiply a vector with a number. When scaling a vector,
            both the <span class="copyable-formula">x</span><math><mi>x</mi></math> and
            <span class="copyable-formula">y</span><math><mi>y</mi></math> components are multiplied by the number,
            for example the vector <span class="copyable-formula">(2, 1)</span><math>
                <mfenced>
                    <mrow>
                        <mn>2</mn>
                        <mo>,</mo>
                        <mn>1</mn>
                    </mrow>
                </mfenced>
            </math> scaled with
            the value <span class="copyable-formula">3</span><math>
                <mrow>
                    <mn>3</mn>
                </mrow>
            </math> will result in the vector <span class="copyable-formula">(3 * 2, 3 * 1)</span><math>
                <mfenced>
                    <mrow>
                        <mn>3</mn>
                        <mo>*</mo>
                        <mn>2</mn>
                        <mo>,</mo>
                        <mn>3</mn>
                        <mo>*</mo>
                        <mn>1</mn>
                    </mrow>
                </mfenced>
            </math> or <span class="copyable-formula">(6, 3)</span><math>
                <mfenced>
                    <mrow>
                        <mn>6</mn>
                        <mo>,</mo>
                        <mn>3</mn>
                    </mrow>
                </mfenced>
            </math>. Vectors can be scaled with both positive and negative numbers, scaling a
            vector with a positive number does not change it's direction, while scaling a vector
            with a negative number will make it point in the opposite direction of the original
            vector. For example, scaling the vector <span class="copyable-formula">(2, 1)</span><math>
                <mfenced>
                    <mrow>
                        <mn>2</mn>
                        <mo>,</mo>
                        <mn>1</mn>
                    </mrow>
                </mfenced>
            </math> with the value <span class="copyable-formula">-1</span><math>
                    <mrow>
                        <mn>-1</mn>
                    </mrow>
            </math> will result in the vector <span class="copyable-formula">(-2, -1)</span><math>
                <mfenced>
                    <mrow>
                        <mn>-2</mn>
                        <mo>,</mo>
                        <mn>-1</mn>
                    </mrow>
                </mfenced>
            </math>.
        </p>
        <figure>
            <img src="vectorscale.svg" class="half-width" />
            <figcaption class="image-caption">When a vector is scaled with a positive number it will still point
                in the same direction as the original vector. When a vector is scaled with a negative number, it
                will point in the direction opposite the original vector.
            </figcaption>
        </figure>
        <p>
            The magnitude of a vector represents its length. This can be calculated by forming a triangle from the
            coordinates of the vector and using the Pythagorean theorem. Given the vector
            <span class="copyable-formula">(x, y)</span><math>
                <mfenced>
                <mrow>
                    <mi>x</mi>
                    <mo>,</mo>
                    <mi>y</mi>
                </mrow>
                </mfenced>
            </math>,
            the magnitude is equal to <span class="copyable-formula">sqrt(x*x + y*y)</span><math>
                <msqrt>
                  <mfenced>
                    <mrow>
                        <msup>
                            <mi>x</mi>
                            <mn>2</mn>
                        </msup>
                      <mo>+</mo>
                      <msup>
                        <mi>y</mi>
                        <mn>2</mn>
                    </msup>
                    </mrow>
                  </mfenced>
                </msqrt>
            </math>. For example, the magnitude of the vector <span class="copyable-formula">(3, 4)</span><math>
                <mfenced>
                <mrow>
                    <mn>3</mn>
                    <mo>,</mo>
                    <mn>4</mn>
                </mrow>
                </mfenced>
            </math>
            is equal to <span class="copyable-formula">sqrt(3*3 + 4*4)</span><math>
                <msqrt>
                  <mfenced>
                    <mrow>
                        <msup>
                            <mn>3</mn>
                            <mn>2</mn>
                        </msup>
                      <mo>+</mo>
                      <msup>
                        <mn>4</mn>
                        <mn>2</mn>
                    </msup>
                    </mrow>
                  </mfenced>
                </msqrt>
            </math> or <span class="copyable-formula">sqrt(9 + 16)</span><math>
                <msqrt>
                    <mn>9</mn>
                    <mo>+</mo>
                    <mn>16</mn>
                </msqrt>
              </math>
            or <span class="copyable-formula">sqrt(25)</span><math><msqrt><mn>25</mn></msqrt></math>
            which equals <span class="copyable-formula">5</span><math><mn>5</mn></math>.
        </p>
        <figure>
            <img src="vectormagnitude.svg" class="half-width" />
            <figcaption class="image-caption">The mangitude of a vector can be calculated using the Pythagorean theorem.
            </figcaption>
        </figure>
        <p>
            Vectors which have a length of <span class="copyable-formula">1</span><math><mn>1</mn></math> are called
            unit vectors, and turning an ordinary vector into a unit vector is called normalization. To normalize a
            vector, we divide the vector by its own magnitude. For example, the vector
            <span class="copyable-formula">(4, 3)</span><math>
                <mfenced><mrow><mn>4</mn><mo>,</mo><mn>3</mn></mrow></mfenced>
            </math>
            has a magnitude of <span class="copyable-formula">5</span><math><mn>5</mn></math>, and after normalization
            this vector has the value <span class="copyable-formula">(4/5, 3/5)</span><math>
                <mfenced>
                    <mrow>
                        <mfrac><mn>4</mn><mn>5</mn></mfrac><mo>,</mo><mn><mfrac><mn>3</mn><mn>5</mn>
                        </mfrac>
                    </mrow>
                </mfenced>
            </math> or <span class="copyable-formula">(0.8, 0.6)</span><math>
                <mfenced><mrow><mn>0.8</mn><mo>,</mo><mn>0.6</mn></mrow></mfenced>
            </math>.
        </p>
        <p>
            Finally, one of the most important operations we can do with vectors is called the dot product. The dot
            product is used in many cases, such as when projecting one vector on another, or when we want to calculate
            the angle between two vectors. The dot product of two vectors is calculated by multiplying their respective
            components and summing the products. For example, the dot product of the vectors
            <span class="copyable-formula">v1 = (x1, y1)</span><math>
                <msub>
                    <mi>v</mi>
                    <mn>1</mn>
                </msub>
                <mo>=</mo>
                <mfenced>
                    <mrow>
                        <msub>
                            <mi>x</mi>
                            <mn>1</mn>
                        </msub>
                        <mo>,</mo>
                        <msub>
                            <mi>y</mi>
                            <mn>1</mn>
                        </msub>
                    </mrow>
                </mfenced>
            </math> and <span class="copyable-formula">v2 = (x2, y2)</span><math>
                <msub>
                    <mi>v</mi>
                    <mn>2</mn>
                </msub>
                <mo>=</mo>
                <mfenced>
                    <mrow>
                        <msub>
                            <mi>x</mi>
                            <mn>2</mn>
                        </msub>
                        <mo>,</mo>
                        <msub>
                            <mi>y</mi>
                            <mn>2</mn>
                        </msub>
                    </mrow>
                </mfenced>
            </math> is 
            <span class="copyable-formula">x1 * x2 + y1 * y2</span><math>
                <mrow>
                    <msub>
                        <mi>x</mi>
                        <mn>1</mn>
                    </msub>
                    <mo>&InvisibleTimes;</mo>
                    <msub>
                        <mi>x</mi>
                        <mn>2</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                        <mi>y</mi>
                        <mn>1</mn>
                    </msub>
                    <mo>&InvisibleTimes;</mo>
                    <msub>
                        <mi>y</mi>
                        <mn>2</mn>
                    </msub>
                </mrow>
            </math>. If we divide this value by the magnitudes of both vectors, we will get
            the cosine of the angle between the vectors.
        </p>
        <span class="copyable-formula">cos(theta) = (v1 dot v2)/(mag(v1) * mag(v2))</span><math display="block">
            <mrow>
                <mi>cos</mi>
                <mo>&ApplyFunction;</mo>
                <mi>&theta;</mi>
                <mo>=</mo>
                <mfrac>
                    <mrow>
                        <msub>
                            <mi>v</mi>
                            <mn>1</mn>
                        </msub>
                        <mo>&sdot;</mo>
                        <msub>
                            <mi>v</mi>
                            <mn>2</mn>
                        </msub>
                    </mrow>
                    <mrow>
                        <mo>|</mo>
                        <msub>
                            <mi>v</mi>
                            <mn>1</mn>
                        </msub>
                        <mo>|</mo>
                        <mo>&InvisibleTimes;</mo>
                        <mo>|</mo>
                        <msub>
                            <mi>v</mi>
                            <mn>2</mn>
                        </msub>
                        <mo>|</mo>
                    </mrow>
                </mfrac>
            </mrow>
        </math>
        <p>
            Now that we've shown what vectors can do, let's write a class called <strong class="code-inline">Vec2</strong>
            which will allow us to create and manipulate vectors. Create a file called <strong class="code-inline">vec2.js</strong>
            and place it on the <strong class="code-inline">src</strong> directory, then add the following code to it:
        </p>
        <pre><code class="language-js">export default class Vec2 {
    constructor(x, y) {
        this.x = x;
        this.y = y;
        Object.freeze(this);
    }

    add(otherVec) {
        return new Vec2(this.x + otherVec.x, this.y + otherVec.y);
    }

    subtract(otherVec) {
        return new Vec2(this.x - otherVec.x, this.y - otherVec.y);
    }

    scale(scalar) {
        return new Vec2(scalar * this.x, scalar * this.y);
    }

    magnitude() {
        return Math.sqrt((this.x*this.x)+(this.y*this.y));
    }

    normalize() {
        let magnitude = this.magnitude();
        return new Vec2(this.x / magnitude, this.y / magnitude);
    }

    dot(otherVector) {
        return this.x * otherVector.x + this.y * otherVector.y;
    }

}</code></pre>
        <p>
            Note the <strong class="code-inline">Object.freeze(this)</strong> statement in line 5.
            By calling that statement we make our <strong class="code-inline">Vec2</strong> class immutable,
            making it impossible to change the values of an instance after its been instantiated.
            Immutability is highly desirable since we can guarantee that no module of our game will
            accidentaly overwrite a vector used by another module. If we need to operate on our
            <strong class="code-inline">Vec2</strong> instance, we'll have to create a new copy.
        </p>
        <p>
            In the following chapters we'll make extensive use of this class when describing the position
            and motion of all game objects.
        </p>
        <p><a href="../c6/">Chapter 6 - Physics and motion</a></p>
    </article>
    <script src="../prism.js"></script>
    <script src="../pixi.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>